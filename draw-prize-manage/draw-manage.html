<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>开奖管理 - 统开奖平台</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin:0; font-family:system-ui,sans-serif; background:#f0f2f5; min-height:100vh; }
    .main { margin-left:240px; padding:20px; }
    .card { background:#fff; border-radius:8px; padding:24px; margin-bottom:24px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    label { display:block; margin:16px 0 8px; font-weight:600; }
    input, select { width:100%; padding:10px; border:1px solid #ddd; border-radius:4px; }
    .range-container { display:flex; align-items:center; gap:12px; }
    .btn { padding:10px 24px; border:none; border-radius:4px; color:#fff; cursor:pointer; font-size:16px; margin:12px 0; width:100%; }
    .btn-primary { background:#1890ff; }
    .btn-danger { background:#f5222d; }
    .log { background:#f6ffed; padding:16px; border-radius:8px; margin-top:20px; display:none; }
  </style>
</head>
<body>

<!-- 左侧固定菜单 -->
<div style="width:240px;background:#001529;color:#fff;height:100vh;position:fixed;top:0;left:0;overflow-y:auto;box-shadow:2px 0 8px rgba(0,0,0,0.3)">
  <div style="padding:20px;font-size:22px;font-weight:bold;border-bottom:1px solid #0f2a47">统开奖平台</div>
  <ul style="list-style:none;margin:16px 0;padding:0">
    <li data-page="dashboard.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='dashboard.html'">仪表盘</li>
    <li data-page="activity-list.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='activity-list.html'">活动管理</li>
    <li data-page="prize-manage.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='prize-manage.html'">奖品管理</li>
    <li data-page="entry-list.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='entry-list.html'">参与记录</li>
    <li data-page="draw-manage.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='draw-manage.html'">开奖管理</li>
    <li data-page="winner-intervene.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='winner-intervene.html'">中奖干预</li>
    <li data-page="statistics.html" style="padding:14px 24px;cursor:pointer;transition:0.3s" onclick="location.href='statistics.html'">数据统计</li>
    <li style="padding:14px 24px;cursor:pointer;transition:0.3s;margin-top:40px" onclick="if(confirm('确定退出？'))location.href='dashboard.html'">退出登录</li>
  </ul>
</div>

<!-- 主内容 -->
<div class="main">
  <h1>开奖管理</h1>

  <div class="card">
    <h2>当前活动：2026双11福利大抽奖</h2>
    <p>活动时间：2026-02-01 00:00 ~ 2026-02-28 23:59</p>
    <p>当前参与人数：<strong id="totalEntry">45672</strong> 人</p>
  </div>

  <div class="card">
    <h3>开奖设置</h3>
    <label>开奖时间</label>
    <input type="datetime-local" id="drawTime" value="2026-03-05T20:00">

    <label>整体中奖概率（人工干预）</label>
    <div class="range-container">
      <input type="range" min="0" max="100" value="100" id="winRate" style="flex:1" oninput="updateRate()">
      <strong id="rateText">100%</strong>
    </div>
    <p>预计中奖人数：<strong id="expectWin">45672</strong> 人</p>

    <label>是否允许一人多中</label>
    <select id="multiWin">
      <option value="1">允许（高奖级优先一人多中）</option>
      <option value="0">不允许（一人最多中一个奖）</option>
    </select>

    <button class="btn btn-primary" onclick="simulateDraw()">开奖前模拟（不锁定）</button>
    <button class="btn btn-danger" onclick="startRealDraw()">一键正式开奖（锁定数据）</button>
  </div>

  <div class="card log" id="drawLog">
    <h3>开奖日志</h3>
    <p id="logContent">暂无日志</p>
  </div>
</div>

<script>
// 高亮当前页面菜单项 + 悬停效果
const currentPath = window.location.pathname.split('/').pop() || 'dashboard.html';
document.querySelectorAll('li').forEach(li => {
  const target = li.dataset.page;
  if (target === currentPath) {
    li.style.background = '#1890ff';
    li.style.fontWeight = 'bold';
  }
  li.addEventListener('mouseover', () => {
    if (!li.style.background.includes('#1890ff')) li.style.background = '#0f2a47';
  });
  li.addEventListener('mouseout', () => {
    if (!li.style.background.includes('#1890ff')) li.style.background = '';
  });
});

function updateRate() {
  const rate = document.getElementById('winRate').value;
  const total = parseInt(document.getElementById('totalEntry').innerText);
  document.getElementById('rateText').innerText = rate + '%';
  document.getElementById('expectWin').innerText = Math.round(total * rate / 100);
}

function simulateDraw() {
  alert('模拟开奖完成（不影响真实数据）\n预计中奖人数：' + document.getElementById('expectWin').innerText);
}

function startRealDraw() {
  const rate = document.getElementById('winRate').value;
  const log = document.getElementById('drawLog');
  const content = document.getElementById('logContent');
  content.innerHTML = `
    开奖成功！<br>
    时间：${new Date().toLocaleString('zh-CN')}<br>
    使用概率：${rate}%<br>
    随机种子：0xA1B2C3D4<br>
    实际中奖人数：${document.getElementById('expectWin').innerText} 人<br>
    奖品库存已锁定，不可回滚
  `;
  log.style.display = 'block';
  alert('正式开奖已触发！数据已锁定。');
}
</script>
</body>
</html>
